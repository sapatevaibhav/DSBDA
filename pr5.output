
Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

Loading required package: lattice
  age          job  marital default education balance housing loan   contact
1  25 entrepreneur divorced      no  tertiary   -4853     yes   no   unknown
2  50 entrepreneur divorced     yes   primary    1391     yes  yes telephone
3  21  blue-collar   single     yes  tertiary   -3551     yes   no   unknown
4  60    housemaid divorced     yes   primary    3342     yes  yes   unknown
5  41   management  married     yes secondary   -1737      no   no   unknown
6  51     services divorced      no   primary   -1138      no   no  cellular
  day month duration campaign pdays previous poutcome y
1  28   mar     1482       14   406       49  failure 0
2  30   sep     1487       16   930        2  success 1
3  21   feb     1278       19   421       35  success 1
4  15   jan      802       23   523       25  unknown 0
5  25   oct     1265        1   785        8  success 1
6  22   feb      539       44   590       37    other 0
      age            job              marital            default         
 Min.   :20.00   Length:500         Length:500         Length:500        
 1st Qu.:31.00   Class :character   Class :character   Class :character  
 Median :43.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :43.88                                                           
 3rd Qu.:56.00                                                           
 Max.   :69.00                                                           
  education            balance           housing              loan          
 Length:500         Min.   :-4991.00   Length:500         Length:500        
 Class :character   1st Qu.:-2513.25   Class :character   Class :character  
 Mode  :character   Median :    8.50   Mode  :character   Mode  :character  
                    Mean   :  -13.97                                        
                    3rd Qu.: 2461.25                                        
                    Max.   : 4998.00                                        
   contact               day           month              duration     
 Length:500         Min.   : 1.00   Length:500         Min.   :   2.0  
 Class :character   1st Qu.: 8.00   Class :character   1st Qu.: 457.0  
 Mode  :character   Median :16.00   Mode  :character   Median : 970.0  
                    Mean   :16.04                      Mean   : 990.2  
                    3rd Qu.:23.25                      3rd Qu.:1570.0  
                    Max.   :30.00                      Max.   :1986.0  
    campaign         pdays          previous       poutcome        
 Min.   : 1.00   Min.   :  5.0   Min.   : 0.00   Length:500        
 1st Qu.:13.00   1st Qu.:275.8   1st Qu.:10.00   Class :character  
 Median :25.00   Median :518.5   Median :23.50   Mode  :character  
 Mean   :25.69   Mean   :512.0   Mean   :23.54                     
 3rd Qu.:39.00   3rd Qu.:747.2   3rd Qu.:37.00                     
 Max.   :49.00   Max.   :999.0   Max.   :49.00                     
       y        
 Min.   :0.000  
 1st Qu.:0.000  
 Median :0.000  
 Mean   :0.476  
 3rd Qu.:1.000  
 Max.   :1.000  
      age       job   marital   default education   balance   housing      loan 
        0         0         0         0         0         0         0         0 
  contact       day     month  duration  campaign     pdays  previous  poutcome 
        0         0         0         0         0         0         0         0 
        y 
        0 
Mid-Age     Old   Young 
    207     178     115 

   0    1 
0.56 0.44 

   0    1 
0.44 0.56 

Call:
glm(formula = y ~ ., family = "binomial", data = train)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7531  -1.0029  -0.6309   1.0960   2.1102  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)  
(Intercept)        -2.227e+00  1.362e+00  -1.635   0.1021  
age                 3.521e-02  2.453e-02   1.435   0.1512  
jobblue-collar      6.192e-01  5.474e-01   1.131   0.2580  
jobentrepreneur    -2.104e-01  5.361e-01  -0.393   0.6946  
jobhousemaid       -7.649e-02  5.805e-01  -0.132   0.8952  
jobmanagement      -1.796e-01  5.386e-01  -0.333   0.7388  
jobretired          9.727e-02  5.068e-01   0.192   0.8478  
jobself-employed    3.043e-01  5.321e-01   0.572   0.5674  
jobservices         4.348e-01  5.518e-01   0.788   0.4307  
jobstudent          9.363e-01  6.253e-01   1.497   0.1343  
jobtechnician       2.026e-01  5.474e-01   0.370   0.7113  
jobunemployed       1.969e-01  5.178e-01   0.380   0.7037  
maritalmarried      1.056e-01  2.955e-01   0.357   0.7209  
maritalsingle       7.376e-02  3.077e-01   0.240   0.8105  
defaultyes         -4.159e-02  2.444e-01  -0.170   0.8649  
educationsecondary  2.933e-01  2.913e-01   1.007   0.3140  
educationtertiary   3.476e-01  3.060e-01   1.136   0.2560  
balance            -3.506e-05  4.303e-05  -0.815   0.4152  
housingyes          1.767e-01  2.419e-01   0.731   0.4650  
loanyes            -3.252e-01  2.499e-01  -1.301   0.1931  
contacttelephone   -3.242e-01  3.021e-01  -1.073   0.2832  
contactunknown     -3.306e-01  2.967e-01  -1.114   0.2651  
monthaug           -5.595e-01  6.656e-01  -0.841   0.4006  
monthdec            7.998e-01  7.280e-01   1.099   0.2720  
monthfeb           -1.179e-01  6.340e-01  -0.186   0.8525  
monthjan           -6.342e-01  6.530e-01  -0.971   0.3314  
monthjul           -8.053e-01  6.572e-01  -1.226   0.2204  
monthjun           -1.756e-01  6.635e-01  -0.265   0.7912  
monthmar           -2.091e-02  6.889e-01  -0.030   0.9758  
monthmay           -2.106e-01  6.762e-01  -0.311   0.7555  
monthnov            2.232e-01  6.466e-01   0.345   0.7300  
monthoct           -9.324e-01  6.998e-01  -1.332   0.1828  
monthsep           -2.084e-02  6.920e-01  -0.030   0.9760  
duration           -2.298e-04  2.014e-04  -1.141   0.2539  
campaign            1.665e-02  8.210e-03   2.028   0.0426 *
pdays               6.969e-04  4.609e-04   1.512   0.1306  
previous            4.526e-03  8.379e-03   0.540   0.5891  
poutcomeother      -8.258e-01  3.329e-01  -2.481   0.0131 *
poutcomesuccess    -3.004e-03  3.302e-01  -0.009   0.9927  
poutcomeunknown    -1.456e-01  3.578e-01  -0.407   0.6841  
age_categoryOld    -2.692e-01  5.481e-01  -0.491   0.6234  
age_categoryYoung   8.602e-01  5.023e-01   1.712   0.0868 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 480.15  on 349  degrees of freedom
Residual deviance: 432.29  on 308  degrees of freedom
AIC: 516.29

Number of Fisher Scoring iterations: 4

Start:  AIC=516.29
y ~ age + job + marital + default + education + balance + housing + 
    loan + contact + month + duration + campaign + pdays + previous + 
    poutcome + age_category

               Df Deviance    AIC
- job          10   438.63 502.63
- month        11   445.48 507.48
- marital       2   432.42 512.42
- education     2   433.89 513.89
- contact       2   433.94 513.94
- default       1   432.32 514.32
- previous      1   432.58 514.58
- housing       1   432.83 514.83
- balance       1   432.96 514.96
- age_category  2   435.48 515.48
- duration      1   433.60 515.60
- loan          1   434.00 516.00
<none>              432.29 516.29
- age           1   434.37 516.37
- pdays         1   434.60 516.60
- campaign      1   436.47 518.47
- poutcome      3   440.76 518.76

Step:  AIC=502.63
y ~ age + marital + default + education + balance + housing + 
    loan + contact + month + duration + campaign + pdays + previous + 
    poutcome + age_category

               Df Deviance    AIC
- month        11   452.41 494.41
- marital       2   438.69 498.69
- education     2   440.31 500.31
- default       1   438.63 500.63
- previous      1   439.05 501.05
- contact       2   441.07 501.07
- balance       1   439.09 501.09
- housing       1   439.10 501.10
- loan          1   439.61 501.61
- duration      1   439.73 501.73
- pdays         1   440.13 502.13
- age_category  2   442.30 502.30
<none>              438.63 502.63
- age           1   440.98 502.98
- campaign      1   443.31 505.31
- poutcome      3   447.96 505.96
+ job          10   432.29 516.29

Step:  AIC=494.41
y ~ age + marital + default + education + balance + housing + 
    loan + contact + duration + campaign + pdays + previous + 
    poutcome + age_category

               Df Deviance    AIC
- marital       2   452.48 490.48
- education     2   454.38 492.38
- default       1   452.41 492.41
- age_category  2   454.74 492.74
- previous      1   452.76 492.76
- balance       1   453.09 493.09
- loan          1   453.29 493.29
- housing       1   453.29 493.29
- contact       2   455.43 493.43
- pdays         1   453.62 493.62
- age           1   453.81 493.81
- duration      1   453.89 493.89
<none>              452.41 494.41
- poutcome      3   460.18 496.18
- campaign      1   457.25 497.25
+ month        11   438.63 502.63
+ job          10   445.48 507.48

Step:  AIC=490.48
y ~ age + default + education + balance + housing + loan + contact + 
    duration + campaign + pdays + previous + poutcome + age_category

               Df Deviance    AIC
- default       1   452.48 488.48
- education     2   454.52 488.52
- age_category  2   454.83 488.83
- previous      1   452.84 488.84
- balance       1   453.18 489.18
- loan          1   453.34 489.34
- housing       1   453.37 489.37
- contact       2   455.66 489.66
- pdays         1   453.69 489.69
- age           1   453.87 489.87
- duration      1   453.96 489.96
<none>              452.48 490.48
- poutcome      3   460.42 492.42
- campaign      1   457.34 493.34
+ marital       2   452.41 494.41
+ month        11   438.69 498.69
+ job          10   445.64 503.64

Step:  AIC=488.48
y ~ age + education + balance + housing + loan + contact + duration + 
    campaign + pdays + previous + poutcome + age_category

               Df Deviance    AIC
- education     2   454.53 486.53
- age_category  2   454.84 486.84
- previous      1   452.84 486.84
- balance       1   453.19 487.19
- loan          1   453.34 487.34
- housing       1   453.37 487.37
- contact       2   455.67 487.67
- pdays         1   453.70 487.70
- age           1   453.87 487.87
- duration      1   453.97 487.97
<none>              452.48 488.48
- poutcome      3   460.42 490.42
+ default       1   452.48 490.48
- campaign      1   457.35 491.35
+ marital       2   452.41 492.41
+ month        11   438.69 496.69
+ job          10   445.66 501.66

Step:  AIC=486.53
y ~ age + balance + housing + loan + contact + duration + campaign + 
    pdays + previous + poutcome + age_category

               Df Deviance    AIC
- age_category  2   456.91 484.91
- previous      1   454.95 484.95
- balance       1   455.04 485.04
- housing       1   455.44 485.44
- loan          1   455.46 485.46
- age           1   455.81 485.81
- contact       2   457.83 485.83
- pdays         1   455.98 485.98
- duration      1   456.16 486.16
<none>              454.53 486.53
- poutcome      3   462.20 488.20
+ education     2   452.48 488.48
+ default       1   454.52 488.52
- campaign      1   459.26 489.26
+ marital       2   454.40 490.40
+ month        11   440.45 494.45
+ job          10   447.40 499.40

Step:  AIC=484.91
y ~ age + balance + housing + loan + contact + duration + campaign + 
    pdays + previous + poutcome

               Df Deviance    AIC
- previous      1   457.26 483.26
- balance       1   457.67 483.67
- loan          1   457.73 483.73
- housing       1   458.05 484.05
- pdays         1   458.09 484.09
- contact       2   460.33 484.33
- age           1   458.52 484.52
- duration      1   458.60 484.60
<none>              456.91 484.91
+ age_category  2   454.53 486.53
+ education     2   454.84 486.84
+ default       1   456.88 486.88
- poutcome      3   464.98 486.98
- campaign      1   461.90 487.90
+ marital       2   456.79 488.79
+ month        11   444.20 494.20
+ job          10   449.39 497.39

Step:  AIC=483.26
y ~ age + balance + housing + loan + contact + duration + campaign + 
    pdays + poutcome

               Df Deviance    AIC
- loan          1   457.99 481.99
- balance       1   458.11 482.11
- housing       1   458.38 482.38
- pdays         1   458.49 482.49
- contact       2   460.66 482.66
- age           1   458.79 482.79
- duration      1   458.96 482.96
<none>              457.26 483.26
+ previous      1   456.91 484.91
+ age_category  2   454.95 484.95
+ education     2   455.13 485.13
+ default       1   457.20 485.20
- poutcome      3   465.44 485.44
- campaign      1   462.28 486.28
+ marital       2   457.14 487.14
+ month        11   444.55 492.55
+ job          10   449.65 495.65

Step:  AIC=481.99
y ~ age + balance + housing + contact + duration + campaign + 
    pdays + poutcome

               Df Deviance    AIC
- balance       1   458.84 480.84
- housing       1   459.03 481.03
- pdays         1   459.07 481.07
- duration      1   459.53 481.53
- age           1   459.65 481.65
- contact       2   461.68 481.68
<none>              457.99 481.99
+ loan          1   457.26 483.26
+ previous      1   457.73 483.73
+ age_category  2   455.76 483.76
+ education     2   455.81 483.81
+ default       1   457.95 483.95
- poutcome      3   466.56 484.56
- campaign      1   462.88 484.88
+ marital       2   457.89 485.89
+ month        11   445.28 491.28
+ job          10   451.06 495.06

Step:  AIC=480.84
y ~ age + housing + contact + duration + campaign + pdays + poutcome

               Df Deviance    AIC
- housing       1   459.91 479.91
- pdays         1   459.99 479.99
- contact       2   462.29 480.29
- duration      1   460.38 480.38
- age           1   460.61 480.61
<none>              458.84 480.84
+ balance       1   457.99 481.99
+ loan          1   458.11 482.11
+ age_category  2   456.36 482.36
+ previous      1   458.51 482.51
+ default       1   458.76 482.76
+ education     2   456.93 482.93
- campaign      1   463.68 483.68
- poutcome      3   467.81 483.81
+ marital       2   458.73 484.73
+ month        11   446.02 490.02
+ job          10   452.24 494.24

Step:  AIC=479.91
y ~ age + contact + duration + campaign + pdays + poutcome

               Df Deviance    AIC
- contact       2   463.03 479.03
- pdays         1   461.03 479.03
- age           1   461.54 479.54
- duration      1   461.62 479.62
<none>              459.91 479.91
+ housing       1   458.84 480.84
+ balance       1   459.03 481.03
+ age_category  2   457.21 481.21
+ loan          1   459.24 481.24
+ previous      1   459.58 481.58
+ default       1   459.86 481.86
+ education     2   457.98 481.98
- poutcome      3   468.83 482.83
- campaign      1   464.92 482.92
+ marital       2   459.78 483.78
+ month        11   446.65 488.65
+ job          10   453.20 493.20

Step:  AIC=479.03
y ~ age + duration + campaign + pdays + poutcome

               Df Deviance    AIC
- pdays         1   464.16 478.16
- age           1   464.77 478.77
- duration      1   465.02 479.02
<none>              463.03 479.03
+ contact       2   459.91 479.91
+ loan          1   462.08 480.08
+ housing       1   462.29 480.29
+ age_category  2   460.31 480.31
+ balance       1   462.40 480.40
+ previous      1   462.74 480.74
+ education     2   460.95 480.95
+ default       1   463.03 481.03
- poutcome      3   471.08 481.08
- campaign      1   468.04 482.04
+ marital       2   462.77 482.77
+ month        11   449.21 487.21
+ job          10   455.38 491.38

Step:  AIC=478.16
y ~ age + duration + campaign + poutcome

               Df Deviance    AIC
- age           1   465.85 477.85
<none>              464.16 478.16
- duration      1   466.25 478.25
+ pdays         1   463.03 479.03
+ contact       2   461.03 479.03
+ loan          1   463.38 479.38
+ housing       1   463.43 479.43
+ balance       1   463.48 479.48
+ age_category  2   461.74 479.74
+ previous      1   463.82 479.82
+ education     2   461.92 479.92
+ default       1   464.15 480.15
- poutcome      3   472.61 480.61
- campaign      1   468.89 480.89
+ marital       2   463.90 481.90
+ month        11   450.38 486.38
+ job          10   457.44 491.44

Step:  AIC=477.85
y ~ duration + campaign + poutcome

               Df Deviance    AIC
- duration      1   467.72 477.72
<none>              465.85 477.85
+ age           1   464.16 478.16
+ contact       2   462.63 478.63
+ pdays         1   464.77 478.77
+ age_category  2   462.87 478.87
+ loan          1   464.92 478.92
+ balance       1   465.08 479.08
+ housing       1   465.23 479.23
+ previous      1   465.58 479.58
+ education     2   463.71 479.71
+ default       1   465.84 479.84
- poutcome      3   473.87 479.87
- campaign      1   470.55 480.55
+ marital       2   465.61 481.61
+ month        11   451.80 485.80
+ job          10   459.14 491.14

Step:  AIC=477.72
y ~ campaign + poutcome

               Df Deviance    AIC
<none>              467.72 477.72
+ duration      1   465.85 477.85
+ contact       2   464.24 478.24
+ age           1   466.25 478.25
+ pdays         1   466.54 478.54
+ age_category  2   464.78 478.78
+ housing       1   466.96 478.96
+ balance       1   466.99 478.99
+ loan          1   467.00 479.00
+ education     2   465.42 479.42
+ previous      1   467.42 479.42
+ default       1   467.70 479.70
- campaign      1   471.94 479.94
- poutcome      3   476.22 480.22
+ marital       2   467.47 481.47
+ month        11   453.29 485.29
+ job          10   461.10 491.10

Call:
glm(formula = y ~ job + marital + default + education + balance + 
    housing + loan + contact + month + duration + campaign + 
    pdays + previous + poutcome + age_category, family = "binomial", 
    data = train)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8177  -0.9946  -0.6535   1.1117   2.1264  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)  
(Intercept)        -6.758e-01  8.246e-01  -0.820   0.4125  
jobblue-collar      5.876e-01  5.463e-01   1.076   0.2821  
jobentrepreneur    -2.440e-01  5.351e-01  -0.456   0.6485  
jobhousemaid       -1.209e-01  5.808e-01  -0.208   0.8351  
jobmanagement      -2.361e-01  5.352e-01  -0.441   0.6592  
jobretired          6.605e-02  5.054e-01   0.131   0.8960  
jobself-employed    2.697e-01  5.294e-01   0.510   0.6104  
jobservices         4.682e-01  5.514e-01   0.849   0.3957  
jobstudent          8.931e-01  6.237e-01   1.432   0.1522  
jobtechnician       1.747e-01  5.475e-01   0.319   0.7496  
jobunemployed       2.032e-01  5.151e-01   0.395   0.6932  
maritalmarried      7.926e-02  2.935e-01   0.270   0.7871  
maritalsingle       5.411e-02  3.062e-01   0.177   0.8597  
defaultyes         -3.718e-02  2.439e-01  -0.152   0.8788  
educationsecondary  2.765e-01  2.902e-01   0.953   0.3406  
educationtertiary   3.566e-01  3.056e-01   1.167   0.2432  
balance            -3.968e-05  4.281e-05  -0.927   0.3540  
housingyes          1.813e-01  2.412e-01   0.751   0.4525  
loanyes            -3.055e-01  2.485e-01  -1.229   0.2189  
contacttelephone   -3.123e-01  3.008e-01  -1.038   0.2992  
contactunknown     -3.418e-01  2.959e-01  -1.155   0.2481  
monthaug           -5.775e-01  6.636e-01  -0.870   0.3842  
monthdec            7.029e-01  7.195e-01   0.977   0.3286  
monthfeb           -1.477e-01  6.329e-01  -0.233   0.8154  
monthjan           -6.398e-01  6.514e-01  -0.982   0.3260  
monthjul           -8.830e-01  6.540e-01  -1.350   0.1770  
monthjun           -1.888e-01  6.607e-01  -0.286   0.7750  
monthmar           -6.527e-02  6.853e-01  -0.095   0.9241  
monthmay           -3.126e-01  6.727e-01  -0.465   0.6422  
monthnov            1.576e-01  6.430e-01   0.245   0.8064  
monthoct           -8.877e-01  6.984e-01  -1.271   0.2037  
monthsep           -4.071e-02  6.890e-01  -0.059   0.9529  
duration           -2.210e-04  2.005e-04  -1.102   0.2703  
campaign            1.642e-02  8.205e-03   2.001   0.0454 *
pdays               7.020e-04  4.587e-04   1.530   0.1260  
previous            2.635e-03  8.258e-03   0.319   0.7496  
poutcomeother      -8.391e-01  3.327e-01  -2.522   0.0117 *
poutcomesuccess    -1.534e-02  3.288e-01  -0.047   0.9628  
poutcomeunknown    -1.711e-01  3.560e-01  -0.481   0.6308  
age_categoryOld     4.148e-01  2.748e-01   1.509   0.1312  
age_categoryYoung   3.158e-01  3.263e-01   0.968   0.3332  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 480.15  on 349  degrees of freedom
Residual deviance: 434.37  on 309  degrees of freedom
AIC: 516.37

Number of Fisher Scoring iterations: 4

Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 38 54
         1 28 30
                                         
               Accuracy : 0.4533         
                 95% CI : (0.372, 0.5366)
    No Information Rate : 0.56           
    P-Value [Acc > NIR] : 0.996562       
                                         
                  Kappa : -0.0644        
                                         
 Mcnemar's Test P-Value : 0.005766       
                                         
            Sensitivity : 0.3571         
            Specificity : 0.5758         
         Pos Pred Value : 0.5172         
         Neg Pred Value : 0.4130         
             Prevalence : 0.5600         
         Detection Rate : 0.2000         
   Detection Prevalence : 0.3867         
      Balanced Accuracy : 0.4665         
                                         
       'Positive' Class : 1              
                            